# 4.역할, 책임, 협력
> 우리 모두를 합친 것보다 더 현명한 사람은 없다 - 켄 블랜차드

- 인간은 어떤 상황에 처해 있는지에 따라 상황에 맞게 행동을 결정한다.
- 중요한 점은 **협력이라는 문맥 안에서** 행동을 결정해야한다는 것이다.
- 협력을 생각하고 그 이후에 행위와 상태를 고려한다.

## 1.협력


### 1.1 요청하고 응답하며 협력하는 사람들
- 협력은 한 사람이 다른 사람에게 도움을 **요청할 때 시작**된다.
- 협력은 **연쇄적인 다수의 요청과 응답**으로 구성된다.

### 1.2 누가 파이를 훔쳤지?
- 상황: 하트 여왕이 마든 파이를 훔쳐 달아다나 붙잡힌 하트 잭에 대한 공판이 열리는 법정
- 목적: 하트 잭 재판하기

### 1.3 재판 속의 협럭

<img width="698" alt="image" src="https://user-images.githubusercontent.com/49191949/171573502-1d7fe23b-12c4-450d-8fae-43994454e824.png">

- 협력의 시작: 누군가 재판 요청 --> 왕
  - 왕은 재판을 수행할 의무(책임)이 있음
  - 재판에 필요한 지식을 갖고 있음
- 왕 --> 토끼: 증인 호출 요청
  - 토끼는 목격자를 부를 의무(책임)이 있음
  - 토끼는 목격자에 대해 알고 있음
- 토끼 --> 모자장수: 증인석 입장 요청
- 모자장수의 입장 = 왕의 증인 호출 요청에 대한 응답
- 왕 --> 모자장수: 증언 요청
  - 모자장수는 증언할 의무(책임)이 있음
- 모자장수의 증언: 왕의 증언 요청 응답


## 2.책임

- 어떤 객체가 어떤 요청에 대해 대답해 줄 수 있거나, 적절한 행동을 할 의무가 있는 경우 해당 객체가 **책임**을 가진다고 말한ㄷ.
- 어떤 대상에 대한 요청 = 요청 받은 대상은 그 요청을 처리할 책임이 있음

### 2.1 책임의 분류

- 객체의 책임은 아는것(knowing)과 **할 수 있는 것(doing)**으로 2가지로 나뉜다.
- 아는 것(knowing)
  - 개인적인 정보에 관해
  - 관련된 객체에 대해
  - 자신이 유도하거나 계산할 수 있는 것
- 하는 것(doing)
  - 객체를 생성하거나 계산하는 등의 스스로 할 수 있는거
  - 다른 객체의 행동을 시작하기
  - 다른 객체의 활동을 제어하고 조절하기
- 예시
  - 왕이 토끼에게 목격자 부르고 목격자 증언하라고 요청
    - 다른 객체들의 활동을 제어하고 조율
  - 토끼의 책임
    - 목격자가 모자장수라는 사실을 알고있는 책임 = 관련된 객체에 대해 아는 것
    - 모자 장수가 증인석으로 입장하도록 요청 = 다른 객체의 행동을 시작시키는 책임
  - 모자장수 책임
    - 스스로 증인석 입장해야 하는 책임 = 객체를 생성하거나 계산을 하는 등의 스스로 하는 것
    - 알고 있는 사실을 증언해야 할 책임 = 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
- 객체의 책임과 인터페이스
  - 책임은 객체의 공용 인터페이스(public interface)로 만든다. 
  - 객체의 외부에 제공해 줄 수 있는 정보 = 아는 것
  - 외부에 제공해 줄 수 있는 서비스 = 하는 것

### 2.2 책임과 메세지
- 책임은 다른 객체로부터 요청을 받았을 때에만 수행한다.
- 메세지 전송(message-send)란 객체가 다른 객체에게 주어진 책임을 수행하도록 요청을 보내는 것을 말한다.
- 송신자: 메세지를 전송함으로써 요청을 보내는 객체
- 수신자: 메세지를 받아 요청을 처리하는 객체

## 3.역할

### 3.1 책임의 집합이 의미하는 것
- 책임의 집합은 **역할**을 의미한다.
- 모자 장수
    - 책임1: 증인석에 입장한다
    - 책임2: 증언한다.
    - 책임1+책임2가 의미하는 것: 모자장수의 역할은 증인이다.
- 역할은 재사용 가능하고 유연한 객체지향 설계를 낳는 매우 중요한 구성요소다.
    - 역할 = 인터페이스

### 3.2 판사와 증인
- 모자장수 --> 요리사, 앨리스로 바꿔도 문제없다
- 왕 --> 여왕으로 바꿔도 문제없다.


### 3.3 역할이 답이다

<img width="465" alt="image" src="https://user-images.githubusercontent.com/49191949/171578738-6bf0afff-db2d-41f0-82af-1925c34adbfc.png">

- 역할을 사용하면 3가지 협력을 포괄하는 하나의 협력으로 추상화할 수 있다.
- 왕 --> 판사(역할)
- 모자장수 --> 증인(역할)
- 역할은 협력 내에서 다른 객체로 대체할 수 있음을 의미한다.
- 역할을 대체할 수 있는 개체는 동일한 메세지를 이해할 수 있는 객체로 한정한다.
  - 동일한 메세지 = 동일한 책임 = 동일한 역할
- 매개변수에 인터페이스를 사용하는 이유(내생각)

- 요약
- 역할(인터페이스)의 장점
  - 단순성(simplicity)
  - 유연성(flexibility)
  - 재사용성(reusability)

### 3.4 협력의 추상화
- 역할은 협력 안 여러 종류의 객체가 참여할 수 있게 협력을 추상화한다.


### 3.5 대체 가능성
- 객체가 역할을 대체하기 위해서는 행동이 호환돼야 한다.
  - = 동일한 역할 = 동일한 책임 = 동일한 메세지
- 객체의 역할은 주어진 책임 이외에 다른 책임을 수행할 수 도 있다.
- 객체는 역할이 암시하는 책임보다 더 많은 책임을 가질 수 있다.


## 4.객체의 모양을 결정하는 협력


### 4.1 흔한 오류
- 객체는 데이터를 저장하기 위해(상태강조) 존재한다. --> X
- 객체는 행위를 수행하며 협력에 참여하기 위해 존재한다. --> O

### 4.2 협력을 따라 흐르는 객체의 책임
- 올바른 객체를 만들기 위해선 먼저 올바른 협력을 설계해야 한다.
- 설계한다는 것은 객체들간 주고받을 요청과 응답을 올바르게 만든다는 것이다.
- 협력 설계 --> 책임(행동) 설계 --> 상태 설계

## 5.객체지향 설계 기법
- 역할, 협력, 책임은 객체지향 설계의 3가지 핵심 요소다.

### 5.1 책임-주도 설계
- 협력에 필요한 책임을 식별하고 적합한 객체에게 책임을 주는 방법론
- 협력 --> 역할, 책임 --> 적합한 객체 선정

### 5.2 디자인 패턴
- 자주사용하는 역할, 책임, 협력 템플릿


### 5.3 테스트-주도 개발
- 테스트를 먼저 작성하고 개발을 하는 방법론
